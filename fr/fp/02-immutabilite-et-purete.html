<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Propre à la Vérité à l'orbe pur</title>

		<meta name="description" content="Immuabilité et pureté dans la programmation fonctionnelle">
		<meta name="author" content="Andrea Cesaro">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="../../css/reset.css">
		<link rel="stylesheet" href="../../css/reveal.css">
		<link rel="stylesheet" href="../../css/theme/sky.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../../lib/css/zenburn.css">

		<style>
			* {
  				box-sizing: border-box;
			}

			/* Create two equal columns that floats next to each other */
			.column {
  				float: left;
  				width: 50%;
  				padding: 10px;
			}

			/* Clear floats after the columns */
			.row:after {
  				content: "";
  				display: table;
  				clear: both;
			}

			div.lowercase {
  				text-transform: lowercase;
			}

			.vertical-center {
  				margin: 0;
  				position: absolute;
  				top: 50%;
  				-ms-transform: translateY(-50%);
			  	transform: translateY(-50%);
			}
		</style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="../../lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h2>Propre à la Vérité à l'orbe pur</h2>
					<h5>Immuabilité et pureté dans la programmation fonctionnelle</h5>
					<p>
						<small>Auteur <a href="http://cexj.github.io">Andrea Cesaro</a>, powered by: <a href="https://github.com/hakimel/reveal.js/">Reveal.js</a></small>
					</p>
				</section>

				<section>
					<h3>Résumé de la présentation</h3>
					<ul>
						<li class="fragment fade-right">Pourquoi l'immuabilité ?</li>
						<li class="fragment fade-right">Immuabilité dans la programmation impérative</li>
						<li class="fragment fade-right">Immuabilité pragmatique</li>
						<li class="fragment fade-right">Immuabilité dans la programmation fonctionnelle</li>
						<li class="fragment fade-right">La pureté</li>
					</ul>
				</section>

				<section>
					<section>
						<h2>Pourquoi l'immuabilité ?</h2>
					</section>					
					<section>
						<h3>Simplicité dans le raisonnement</h3>
						<pre class="fragment fade-right"><code class="hljs" data-trim>Page page = repo.getPageById(id);
...
Integer numLines =  page.getNumLines();

							</code></pre>
					</section>
					<section>
						<h3>Simplicité dans le partage entre procedures</h3>
						<pre class="fragment fade-right"><code class="hljs" data-trim>Page page = repo.getPageById(id);
...
Page engPage = GoogleTranslateUtils.translate(page);
							</code></pre>
					</section>
					<section>
						<h3>Simplicité dans le partage entre threads</h3>
						<p class="fragment fade-right">Les variables en seule lecture n'ont pas besoin des synchronisation</p>
					</section>
				</section>
				<section>
					<section>
						<h2>Immuabilité dans la programmation impérative</h2>
					</section>
					<section>
						<h3>Dans une procédure linéaire</h3>
						<p class="fragment fade-right">Une nouvelle valeur est créée à chaque étape</p>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
Book correctWord(Book oldBook, Integer index,
                 Word oldWord, Word newWord){
 Page oldPage = oldBook.getPageByIndex(index);
 Page newPage = oldPage.changeWord(oldWord,newWord);
 Book newBook = oldBook.changePageAtIndex(newPage,index);
 return newBook;
}
						</code></pre>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
Book correctWord(Book oldBook, Integer index,
                 Word oldWord, Word newWord){
  return oldBook.getPageByIndex(index)
                .changeWord(oldWord,newWord)
                .changePageAtIndex(newPage,index);
}
						</code></pre>
					</section>
					<section>
						<h3>Dans une instruction conditionnelle</h3>
						<p class="fragment fade-right">À chacun <b>if</b> correspond un <b>else</b></p>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
Integer numPages(Book book, Boolean withIndex){
 Integer result;
 if(withIndex){
  result = book.getNumPages() + book.getIndex().size();
 } else {
  result = book.getNumPages();
 }
 return result;
}
						</code></pre>
					</section>
					<section>
						<h3>Dans une boucle</h3>
						<p class="fragment fade-right">Nous ne pouvons pas ! Les boucles sont liées à la mutabilité</p>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
...
while(mutableCondiction){
 ...
}
...						</code></pre>
					</section>
					<section>
						<h3>Dans les structures de données</h3>
						<p class="fragment fade-right">Rendre un objet immutable c'est difficile</p>
						<p class="fragment fade-right">Copier simplement une grande collection peut être très lourd</p>
					</section>
				</section>
				<section>
					<section>
						<h2>Immuabilité pragmatique</h2>
					</section>
					<section>
						<h3>Dans une boucle</h3>
						<p class="fragment fade-right">Utiliser des variables temporaires pour les mutations, dans la plus petite scope possible</p>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
...
Integer maxNumPageTemp = 0;
for(Book book:books){
 if(book.getNumPage() &gt; maxNumPageTemp){
  maxNumPageTemp = book.getNumPage();
 }
}
Integer maxNumPage = maxNumPageTemp;
...
						</code></pre>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
...
Integer maxNumPage = extractMaxNumPage(books);
...
						</code></pre>
					</section>
					<section>
						<h2>Si possible utiliser des API fonctionnelles</h2>
						<p class="fragment fade-right">Ils cachent l'implémentation mutable et ils donnent des interfaces trés flexibles</p>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
...
Integer maxNumPage = books.stream()
                          .map(Book::getNumPage)
                          .max((x,y) -> x < y)
                          .orElse(0);
...
						</code></pre>
					</section>
					<section>
						<h3>Dans le cas d'un objet (Java/C#)</h3>
						<ul>
							<li class="fragment fade-right">Definir les champs comment <b>private</b> et <b>final</b></li>
							<li class="fragment fade-right">Ne definir pas des methodes <b>set</b></li>
							<li class="fragment fade-right">Definir la classe comment <b>final</b></li>
							<li class="fragment fade-right">Copie défensive entrée et sortie</li>
						</ul>
					</section>
					<section>
						<h3>Dans le cas d'une collection</h3>
						<ul>
							<li class="fragment fade-right">Il exist des versions de collections immutables, elles ont des propriétés différentes des collections mutables
								<p class="fragment fade-right">Les logiciels de gestion de versions, comme <b>git</b> sont des collections immutables</p></li>
							<li class="fragment fade-right">La strategie d'evaluations des expressions-&lambda; peut etre utilisé pour optimiser le code (graphe orienté acyclique)
								<p class="fragment fade-right">Les <b>Stream</b> en Java pour exemple</p></li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>Immuabilité dans la programmation fonctionnelle</h2>
					</section>
					<section>
						<h3>Un peu plus d'histoire</h3>
						<ul>
							<li class="fragment fade-right">(&sim;1930) <b>Alonzo Church</b> introduit le <b>&lambda;-Calculus</b></li>
							<li class="fragment fade-right">(&sim;1930) <b>Alan Turing</b> introduit la <b>Machine de Turing</b></li>
							<li class="fragment fade-right">(&sim;1930) <b>Kurt Gödel</b> et <b>Jacques Herbrand</b> introduit le <b>functions &mu;-recursives</b></li>
							<li class="fragment fade-right">(&sim;1936) <b>Alonzo Church</b> et <b>Alan Turing</b> prouvent l'équivalence des trois théories</li>

						</ul>
					</section>
					<section>
						<h3>La recursion peut étre utilisé au lieu des boucles</h3>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
Integer factorial(Integer n){
 Integer result=1;
 if(n&gt;1){
  for(int i=1;i<=n;i++){
   result=result*i;
  }
 }
 return result;
}
						</code></pre>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
Integer factorial(Integer n){
 if(n&gt;1) return n*factorial(n-1);
 else return 1;
}
						</code></pre>
					</section>
					<section>
						<h3>Quel est le problème de la recursion ?</h3>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
Integer infinite(){
 if(true) return infinite();
 else return 0;
}
						</code></pre>
						<p class="fragment fade-right" style="color: red">Exception in thread "main" java.lang.StackOverflowError</p>
					</section>
					<section>
						<h3>Tail recursion</h3>
						<p class="fragment fade-right">Chaque fonction récursive peut étre transformé dans une forme dit <b>tail recursive</b></p>
						<p class="fragment fade-right">Les ccompilateurs / interpréteurs des langages fonctionnelles implémentent la <b>tail recursive optimisation</b></p>
					</section>
					<section>
						<h3>Immutabilité</h3>
						<p class="fragment fade-right">Par default ou tres simple à realiser</p>
						<pre class="fragment fade-right"><code class="hljs" data-trim>
case class Book(title: String, pageNumber: Int = 0){
 def desc(): String = s"The book $book has $pageNumber pages"
}
						</code></pre>
						<p class="fragment fade-right">Il permet d'avoir du <b>filtrage par motif</b> (<b>pattern matching</b>)</p>
					</section>
				</section>
				<section>
					<section>
						<h2>La pureté</h2>
					</section>
					<section>
						<h3>Exemple</h3>
						<div class="fragment fade-right">
							<p>Architecture en couches</p>
							<img src="img/3tiers.png" alt="Down arrow" style="border:0px">
						</div>
					</section>
					<section>
						<h3>Exemple</h3>
						<div class="fragment fade-right">
							<p>Séparation pur / impur</p>
							<img src="img/3pure.png" alt="Down arrow"  style="border:0px">
						</div>
					</section>
					<section>
						<h3>Exemple</h3>
						<div class="fragment fade-right">
							<p>"Architecture" centré sur la logique</p>
							<img src="img/6pure.png" alt="Down arrow"  style="border:0px">
						</div>
					</section>
				</section>
				<section>
					<div class="row">
						<div class="column">
							<img width="400" height="390" src="img/order_and_chaos.jpg" alt="Down arrow">
						</div>
						<div class="column">
							<div class="vertical-center">
								<div style="line-height: 200%"><small>
									<div><b>Email:</b> andrea.cesaro-ISC.france</div><br>
									<div><b>Link:</b> <a href="https://cexj.github.io/slides/fr/fp/02-immutabilite-et-purete.html">https://cexj.github.io/slides/fr/fp/02-immutabilite-et-purete.html</a></div><br>
									<div><b>Slack IBM:</b> lambda</div>
								</small></div>
							</div>
						</div>
					</div>
				</section>
			</div>

		</div>

		<script src="../../js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: '../../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../../plugin/highlight/highlight.js', async: true },
					{ src: '../../plugin/search/search.js', async: true },
					{ src: '../../plugin/zoom-js/zoom.js', async: true },
					{ src: '../../plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
